(this.webpackJsonpqys=this.webpackJsonpqys||[]).push([[0],{152:function(e,t,a){e.exports=a(197)},157:function(e,t,a){},196:function(e,t,a){},197:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),i=a(58),o=a.n(i),s=(a(157),a(114)),l=a(31),c=a(4),u=a(5),d=a(6),h=a(8),p=a(7),m=a(149),f=a.n(m),y=a(26);function g(e){return~~(e/4)}function v(){for(var e=36,t=Array.from(Array(e).keys());e;){var a=Math.floor(Math.random()*e--),n=[t[e],t[a]];t[a]=n[0],t[e]=n[1]}return t}function w(e,t){return 0===e.length?[[0,t]]:[].concat(Object(y.a)(e),[[e[e.length-1][0]+1,t]]).slice(-4)}var b=a(45),O=a(36),j=a(113),k=a.n(j),E=k.a.mark(S);function S(e){var t;return k.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:t=0;case 1:if(!(t<e)){a.next=7;break}return a.next=4,t;case 4:t++,a.next=1;break;case 7:case"end":return a.stop()}}),E)}function C(e){var t,a=Object(O.a)(e.entries());try{for(a.s();!(t=a.n()).done;){var n=Object(b.a)(t.value,2),r=n[0];if(!(n[1]<2)){var i=Object(y.a)(e);if(i[r]-=2,B(i))return!0}}}catch(o){a.e(o)}finally{a.f()}return!1}function B(e){var t,a=Object(O.a)(S(7));try{for(a.s();!(t=a.n()).done;){var n=t.value;if(e[n]<0)return!1;e[n]%=3;var r,i=e[n],o=Object(O.a)(S(3));try{for(o.s();!(r=o.n()).done;){e[n+r.value]-=i}}catch(c){o.e(c)}finally{o.f()}}}catch(c){a.e(c)}finally{a.f()}var s,l=Object(O.a)(e);try{for(l.s();!(s=l.n()).done;){if(s.value%3)return!1}}catch(c){l.e(c)}finally{l.f()}return!0}function D(e){var t,a=0,n=0,r=Object(O.a)(e);try{for(r.s();!(t=r.n()).done;){switch(t.value){case 0:continue;case 3:a+=1;continue;case 2:n+=1;continue;default:return!1}}}catch(i){r.e(i)}finally{r.f()}return a<=1&&n%3===1}function T(e){var t=Object(y.a)(e.hand);return t.push(e.pile[e.p]),Object(c.a)({},e,{hand:t,p:e.p+1})}function G(e){return Object(c.a)({},e,{hand:e.pile.slice(0,e.p)})}function A(e){console.log(e);var t=Object(y.a)(e.hand);t.sort((function(e,t){return e-t}));var a=Object(c.a)({},e,{hand:t});return console.log(a),a}function x(e,t,a){return G({hand:[],p:a,pile:e(),started:t()})}function N(e){switch(e){case"disallow":return C;case"allow":return function(e){return C(e)||D(e)};case"allow-hog":return function(e){return C(e)||D(e)||function(e){var t,a=0,n=0,r=Object(O.a)(e);try{for(r.s();!(t=r.n()).done;){var i=t.value;if(3!==i){if(i%2)return!1;n+=i/2}else a+=1}}catch(o){r.e(o)}finally{r.f()}return a<=1&&n%3===1}(e)}}}function L(e){switch(e.tileStyle){case"PostModern":switch(e.tileSuit){case"bamboos":return z;case"characters":return V;case"dots":return U}case"GLMahjongTile":switch(e.tileSuit){case"bamboos":return K;case"characters":return J;case"dots":return _}}}function M(e){switch(e.tileStyle){case"PostModern":return 88;case"GLMahjongTile":return 91}}var F=function(e){Object(h.a)(a,e);var t=Object(p.a)(a);function a(e){var n;return Object(u.a)(this,a),(n=t.call(this,e)).handleWindowResize=function(){console.log("windowInnerWidth: ".concat(window.innerWidth)),n.setState({windowInnerWidth:window.innerWidth})},n.handleTimeRestChanged=function(){if("playing"===n.props.game.kind){var e=n.props.game.started.valueOf()+n.state.settings.timeOfGame-(new Date).valueOf();e<0&&(e=0),n.setState({timeRest:e})}},n.handleHandLengthChanged=function(e){n.setState({settings:Object(c.a)({},n.state.settings,{handLength:parseInt(e.target.value)})})},n.handleTileStyleChanged=function(e){n.setState({theme:Object(c.a)({},n.state.theme,{tileStyle:e.target.value})})},n.handleTileSuitChanged=function(e){n.setState({theme:Object(c.a)({},n.state.theme,{tileSuit:e.target.value})})},n.handleAllowPairsChanged=function(e){n.setState({settings:Object(c.a)({},n.state.settings,{allowPairs:e.target.value})})},n.handleTimeBeforeDrawChanged=function(e){n.setState({settings:Object(c.a)({},n.state.settings,{timeBeforeDraw:parseInt(e.target.value)})})},n.handleTimeBeforeSortChanged=function(e){n.setState({settings:Object(c.a)({},n.state.settings,{timeBeforeSort:parseInt(e.target.value)})})},n.handleTimeOfGameChanged=function(e){n.setState({settings:Object(c.a)({},n.state.settings,{timeOfGame:parseInt(e.target.value)})})},n.declareHu=function(){return n.props.actions.declareHu({validator:N(n.state.settings.allowPairs),next:x(n.props.initializer,(function(){return new Date}),n.state.settings.handLength),timeBeforeDraw:n.state.settings.timeBeforeDraw,timeBeforeSort:n.state.settings.timeBeforeSort})},n.directDiscardAndDraw=function(){if("playing"!==n.props.game.kind)throw new TypeError;return n.discardAndDraw(n.props.game.deal.hand.length-1)},n.discardAndDraw=function(e){return n.props.actions.discardAndDraw({position:e,timeBeforeDraw:n.state.settings.timeBeforeDraw,timeBeforeSort:n.state.settings.timeBeforeSort})},n.resetGame=function(){return n.props.actions.resetGame({first:x(n.props.initializer,(function(){return new Date}),n.state.settings.handLength),timeBeforeDraw:n.state.settings.timeBeforeDraw,timeBeforeSort:n.state.settings.timeBeforeSort,timeOfGame:n.state.settings.timeOfGame})},n.nullGame=function(){return n.props.actions.nullGame({})},n.handleKeydown=function(e){if(32===e.keyCode)return e.preventDefault(),n.declareHu();if(!(e.keyCode<48)){if(48===e.keyCode)return n.directDiscardAndDraw();if(83===e.keyCode)return n.resetGame();if(!(58<=e.keyCode)){if("playing"!==n.props.game.kind)throw new TypeError;console.log("keyCode: ".concat(e.keyCode));var t=e.keyCode-49;console.log("rank: ".concat(t));var a=n.props.game.deal.hand.findIndex((function(e,a){return console.log("".concat(a,": ").concat(e)),g(e)===t}));return console.log("position: ".concat(a)),0<=a?n.discardAndDraw(a):void 0}}},n.state={settings:{handLength:13,allowPairs:"allow",timeBeforeDraw:1e3,timeBeforeSort:500,timeOfGame:6e4},theme:{tileStyle:"PostModern",tileSuit:"dots"},timeRest:null,displayTime:null,windowInnerWidth:window.innerWidth},n}return Object(d.a)(a,[{key:"componentDidMount",value:function(){document.addEventListener("keydown",this.handleKeydown),this.setState({displayTime:setInterval(this.handleTimeRestChanged,10)}),window.addEventListener("resize",this.handleWindowResize)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.handleKeydown),clearInterval(this.state.displayTime),window.removeEventListener("resize",this.handleWindowResize)}},{key:"render",value:function(){return console.log(this.props),console.log(this.state),r.a.createElement(r.a.Fragment,null,r.a.createElement(H,{theme:this.state.theme,hand:"playing"===this.props.game.kind?this.props.game.deal.hand:[],tileClass:L(this.state.theme),maxTiles:this.state.settings.handLength+1,discard:this.discardAndDraw,width:this.state.windowInnerWidth}),r.a.createElement($,{score:"null"===this.props.game.kind?null:this.props.game.score,time:this.state.timeRest,hu:this.declareHu,reset:this.resetGame,handLength:{handler:this.handleHandLengthChanged},tileStyle:{handler:this.handleTileStyleChanged},tileSuit:{handler:this.handleTileSuitChanged},allowPairs:{handler:this.handleAllowPairsChanged},timeBeforeDraw:{handler:this.handleTimeBeforeDrawChanged,value:this.state.settings.timeBeforeDraw},timeBeforeSort:{handler:this.handleTimeBeforeSortChanged,value:this.state.settings.timeBeforeSort},timeOfGame:{handler:this.handleTimeOfGameChanged,value:this.state.settings.timeOfGame}}),r.a.createElement(Y,{messages:this.props.messages}),r.a.createElement(ae,{close:this.nullGame,isOpen:"finished"===this.props.game.kind,score:~~(1e3*("null"===this.props.game.kind?0:this.props.game.score)),settings:(e=this.state.settings,"".concat(e.handLength).concat("disallow"===e.allowPairs?"":"allow"===e.allowPairs?"p":"pp"," ").concat(e.timeOfGame/1e3,"/").concat(e.timeBeforeDraw/1e3)+(e.timeBeforeSort<e.timeBeforeDraw?"(".concat(e.timeBeforeSort/1e3,")"):""))}));var e}}]),a}(r.a.Component),H=function(e){Object(h.a)(a,e);var t=Object(p.a)(a);function a(){return Object(u.a)(this,a),t.apply(this,arguments)}return Object(d.a)(a,[{key:"renderTile",value:function(e,t){var a=this;return r.a.createElement(this.props.tileClass,{key:t,rank:g(t),onClick:function(){return a.props.discard(e)}})}},{key:"render",value:function(){var e=this;return console.log(this.state),r.a.createElement(P,{scale:this.props.width/(64*this.props.maxTiles),height:M(this.props.theme)},r.a.createElement(I,{width:64*this.props.maxTiles,scale:this.props.width/(64*this.props.maxTiles)},this.props.hand.map((function(t,a){return e.renderTile(a,t)}))))}}]),a}(r.a.Component),P=function(e){Object(h.a)(a,e);var t=Object(p.a)(a);function a(){return Object(u.a)(this,a),t.apply(this,arguments)}return Object(d.a)(a,[{key:"render",value:function(){return r.a.createElement("div",{className:"hand-container",style:{height:"".concat(this.props.scale*this.props.height,"px")}},this.props.children)}}]),a}(r.a.Component),I=function(e){Object(h.a)(a,e);var t=Object(p.a)(a);function a(){return Object(u.a)(this,a),t.apply(this,arguments)}return Object(d.a)(a,[{key:"render",value:function(){return r.a.createElement("div",{className:"hand",style:{width:"".concat(this.props.width,"px"),transformOrigin:"top left",transform:"scale(".concat(this.props.scale,")")}},this.props.children)}}]),a}(r.a.Component),W=function(e){Object(h.a)(a,e);var t=Object(p.a)(a);function a(){return Object(u.a)(this,a),t.apply(this,arguments)}return Object(d.a)(a,[{key:"render",value:function(){return r.a.createElement("div",{className:"tile ".concat(this.tileClass()),onClick:this.props.onClick},r.a.createElement("img",{src:this.imageUrl(),style:this.generateStyle(this.props.rank),alt:(this.props.rank+1).toString()}))}},{key:"tileClass",value:function(){throw new TypeError("tileClass() is not implemented")}},{key:"imageUrl",value:function(){throw new TypeError("imageUrl() is not implemented")}},{key:"generateStyle",value:function(e){throw new TypeError("")}}]),a}(r.a.Component),R=function(e){Object(h.a)(a,e);var t=Object(p.a)(a);function a(){return Object(u.a)(this,a),t.apply(this,arguments)}return Object(d.a)(a,[{key:"generateStyle",value:function(e){return{clip:"rect(".concat(this.top(e),", ").concat(this.right(e),", ").concat(this.bottom(e),", ").concat(this.left(e),")"),top:-this.top(e),left:-this.left(e)}}},{key:"tileClass",value:function(){return"pm"}},{key:"right",value:function(e){throw new TypeError("right() is not implemented")}},{key:"left",value:function(e){throw new TypeError("left() is not implemented")}},{key:"top",value:function(e){return 0}},{key:"bottom",value:function(e){return 88}},{key:"imageUrl",value:function(){return"postmodern.svg"}}]),a}(W),z=function(e){Object(h.a)(a,e);var t=Object(p.a)(a);function a(){return Object(u.a)(this,a),t.apply(this,arguments)}return Object(d.a)(a,[{key:"left",value:function(e){return 64*(24+e)}},{key:"right",value:function(e){return 64*(25+e)}}]),a}(R),V=function(e){Object(h.a)(a,e);var t=Object(p.a)(a);function a(){return Object(u.a)(this,a),t.apply(this,arguments)}return Object(d.a)(a,[{key:"left",value:function(e){return 64*(15+e)}},{key:"right",value:function(e){return 64*(16+e)}}]),a}(R),U=function(e){Object(h.a)(a,e);var t=Object(p.a)(a);function a(){return Object(u.a)(this,a),t.apply(this,arguments)}return Object(d.a)(a,[{key:"left",value:function(e){return 64*(0+e)}},{key:"right",value:function(e){return 64*(1+e)}}]),a}(R),q=function(e){Object(h.a)(a,e);var t=Object(p.a)(a);function a(){return Object(u.a)(this,a),t.apply(this,arguments)}return Object(d.a)(a,[{key:"suit",value:function(){throw new TypeError("suit() is not implemented")}},{key:"imageUrl",value:function(){return"gl-mahjongtile-svg/".concat(this.suit(),"-").concat(this.props.rank,".svg")}},{key:"tileClass",value:function(){return"gl"}},{key:"generateStyle",value:function(e){return{transform:"scale(1, -1)"}}}]),a}(W),K=function(e){Object(h.a)(a,e);var t=Object(p.a)(a);function a(){return Object(u.a)(this,a),t.apply(this,arguments)}return Object(d.a)(a,[{key:"suit",value:function(){return"b"}}]),a}(q),J=function(e){Object(h.a)(a,e);var t=Object(p.a)(a);function a(){return Object(u.a)(this,a),t.apply(this,arguments)}return Object(d.a)(a,[{key:"suit",value:function(){return"c"}}]),a}(q),_=function(e){Object(h.a)(a,e);var t=Object(p.a)(a);function a(){return Object(u.a)(this,a),t.apply(this,arguments)}return Object(d.a)(a,[{key:"suit",value:function(){return"d"}}]),a}(q),Y=function(e){Object(h.a)(a,e);var t=Object(p.a)(a);function a(){return Object(u.a)(this,a),t.apply(this,arguments)}return Object(d.a)(a,[{key:"render",value:function(){return r.a.createElement("ul",{className:"status"},this.props.messages.map((function(e){return r.a.createElement("li",{key:e[0]},e[1])})))}}]),a}(r.a.Component),$=function(e){Object(h.a)(a,e);var t=Object(p.a)(a);function a(){return Object(u.a)(this,a),t.apply(this,arguments)}return Object(d.a)(a,[{key:"renderHuButton",value:function(){return r.a.createElement(te,{onClick:this.props.hu})}},{key:"renderStatus",value:function(){return r.a.createElement("div",{className:"status-labels"},r.a.createElement("div",{className:"status-label"},null==this.props.score?"":"score: ".concat(~~(1e3*this.props.score))),r.a.createElement("div",{className:"status-label"},null==this.props.time?"":"time: ".concat((this.props.time/1e3).toFixed(2))))}},{key:"renderStartButton",value:function(){return r.a.createElement(ee,{onClick:this.props.reset})}},{key:"renderHandLength",value:function(){return r.a.createElement("fieldset",{className:"hand-length"},r.a.createElement("span",{className:"radio-label"},"#tiles"),r.a.createElement(Q,{choices:[1,4,7,10,13,16].map((function(e){return{display:ne(e,2),value:e}})),name:"hand-length",defaultValue:13,onChange:this.props.handLength.handler}))}},{key:"renderTileStyle",value:function(){return r.a.createElement("fieldset",{className:"tile-style"},r.a.createElement("span",{className:"radio-label"},"tile style"),r.a.createElement(Q,{choices:[{display:"PostModern",value:"PostModern"},{display:"GL-MT",value:"GLMahjongTile"}],name:"tile-style",defaultValue:"PostModern",onChange:this.props.tileStyle.handler}))}},{key:"renderTileSuit",value:function(){return r.a.createElement("fieldset",{className:"tile-suit"},r.a.createElement("span",{className:"radio-label"},"suit"),r.a.createElement(Q,{choices:[{display:"bams/\u7d22/\u6761",value:"bamboos"},{display:"chars/\u842c/\u4e07",value:"characters"},{display:"dots/\u7b52/\u997c",value:"dots"}],name:"tile-suit",defaultValue:"dots",onChange:this.props.tileSuit.handler}))}},{key:"renderAllowPairs",value:function(){return r.a.createElement("fieldset",{className:"allow-pairs"},r.a.createElement("span",{className:"radio-label"},"pairs"),r.a.createElement(Q,{choices:[{display:"disallow",value:"disallow"},{display:"allow",value:"allow"},{display:"tile hog",value:"allow-hog"}],name:"allow-pairs",defaultValue:"allow",onChange:this.props.allowPairs.handler}))}},{key:"renderTimeBeforeDraw",value:function(){return r.a.createElement("fieldset",null,r.a.createElement(Z,{id:"time-before-draw",label:"time before draw",handler:this.props.timeBeforeDraw.handler,value:{min:100,max:9900,step:100,default:1e3,display:(this.props.timeBeforeDraw.value/1e3).toFixed(1)+"s"}}))}},{key:"renderTimeBeforeSort",value:function(){return r.a.createElement("fieldset",null,r.a.createElement(Z,{id:"time-before-sort",label:"time before sort",handler:this.props.timeBeforeSort.handler,value:{min:0,max:9900,step:100,default:500,display:(this.props.timeBeforeSort.value/1e3).toFixed(1)+"s"}}))}},{key:"renderTimeOfGame",value:function(){return r.a.createElement("fieldset",null,r.a.createElement(Z,{id:"time-of-game",label:"time of game",handler:this.props.timeOfGame.handler,value:{min:3e4,max:6e5,step:1e3,default:6e4,display:r.a.createElement(r.a.Fragment,null,ne(this.props.timeOfGame.value/1e3,3),"s")}}))}},{key:"render",value:function(){return r.a.createElement("form",{className:"controls"},this.renderHuButton(),this.renderStatus(),this.renderStartButton(),this.renderHandLength(),this.renderTileStyle(),this.renderTileSuit(),this.renderAllowPairs(),this.renderTimeBeforeDraw(),this.renderTimeBeforeSort(),this.renderTimeOfGame())}}]),a}(r.a.Component),Q=function(e){Object(h.a)(a,e);var t=Object(p.a)(a);function a(){return Object(u.a)(this,a),t.apply(this,arguments)}return Object(d.a)(a,[{key:"render",value:function(){var e=this;return r.a.createElement(r.a.Fragment,null,this.props.choices.map((function(t,a){return r.a.createElement(X,{key:a,name:e.props.name,value:t.value,display:t.display,onChange:e.props.onChange,defaultValue:e.props.defaultValue})})))}}]),a}(r.a.Component),X=function(e){Object(h.a)(a,e);var t=Object(p.a)(a);function a(){return Object(u.a)(this,a),t.apply(this,arguments)}return Object(d.a)(a,[{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement("input",{type:"radio",name:this.props.name,id:"".concat(this.props.name,"-").concat(this.props.value),value:this.props.value,onChange:this.props.onChange,defaultChecked:this.props.value===this.props.defaultValue}),r.a.createElement("label",{htmlFor:"".concat(this.props.name,"-").concat(this.props.value)},this.props.display))}}]),a}(r.a.Component),Z=function(e){Object(h.a)(a,e);var t=Object(p.a)(a);function a(){return Object(u.a)(this,a),t.apply(this,arguments)}return Object(d.a)(a,[{key:"render",value:function(){var e=this.props.value,t=this.props.id;return r.a.createElement(r.a.Fragment,null,r.a.createElement("label",{htmlFor:t},this.props.label),r.a.createElement("input",{type:"range",id:t,name:t,min:e.min,max:e.max,step:e.step,defaultValue:e.default,onChange:this.props.handler}),r.a.createElement("output",{htmlFor:t},e.display))}}]),a}(r.a.Component),ee=function(e){Object(h.a)(a,e);var t=Object(p.a)(a);function a(){return Object(u.a)(this,a),t.apply(this,arguments)}return Object(d.a)(a,[{key:"render",value:function(){return r.a.createElement("div",{className:"start-button",onClick:this.props.onClick},r.a.createElement("span",{className:"start-text"},"start"))}}]),a}(r.a.Component),te=function(e){Object(h.a)(a,e);var t=Object(p.a)(a);function a(){return Object(u.a)(this,a),t.apply(this,arguments)}return Object(d.a)(a,[{key:"render",value:function(){return r.a.createElement("div",{className:"hu-button",onClick:this.props.onClick},r.a.createElement("span",{className:"hu-text"},"Hu"))}}]),a}(r.a.Component),ae=function(e){Object(h.a)(a,e);var t=Object(p.a)(a);function a(){return Object(u.a)(this,a),t.apply(this,arguments)}return Object(d.a)(a,[{key:"renderText",value:function(){return encodeURIComponent("Score: ".concat(this.props.score," (settings: ").concat(this.props.settings,")"))}},{key:"render",value:function(){return r.a.createElement(f.a,{isOpen:this.props.isOpen,shouldCloseOnOverlayClick:!0,className:"result-content",overlayClassName:"result-overlay"},r.a.createElement("div",{className:"result-score"},"Your score: ",this.props.score),r.a.createElement("div",{className:"result-controls"},r.a.createElement("div",{className:"result-close",onClick:this.props.close},"Close"),r.a.createElement("a",{className:"result-tweet",href:"https://twitter.com/intent/tweet?text=".concat(this.renderText(),"&url=https%3A%2F%2Fmajiang.github.io%2Fmj%2Fqys%2F&hashtags=qysmj&related=__DaLong")},r.a.createElement("div",null,"Tweet"))))}}]),a}(r.a.Component);function ne(e,t){var a=e.toString().length;return r.a.createElement(r.a.Fragment,null,r.a.createElement("span",{className:"transparent"},"0".repeat(t-a)),e)}var re=a(204),ie=a(203),oe=a(78);function se(e,t){return Object(ie.a)(Object(c.a)({},t,{type:e.type,process:function(a,n,r){var i=a.action,o=a.getState;if(!Object(oe.isType)(i,e))throw new TypeError;t.process({action:i,getState:o},n,r)},validate:void 0,transform:void 0}))}var le=a(150),ce=Object(oe.actionCreatorFactory)();function ue(e){return function(t){if("playing"!==t.game.kind)throw new TypeError;return Object(c.a)({},t,{game:Object(c.a)({},t.game,{deal:e(t.game.deal)})})}}var de={appendMessage:ce("appendMessage"),discard:ce("discard"),draw:ce("draw"),discardAndDraw:ce("discardAndDraw"),declareHu:ce("declareHu"),deal:ce("deal"),dealAndDraw:ce("dealAndDraw"),resetGame:ce("resetGame"),newGame:ce("newGame"),newGameAndDraw:ce("newGameAndDraw"),sort:ce("sort"),sortAndDraw:ce("sortAndDraw"),scoreHu:ce("scoreHu"),scoreCuohu:ce("scoreCuohu"),finish:ce("finish"),nullGame:ce("nullGame")},he=Object(le.reducerWithInitialState)({game:{kind:"null"},messages:[]}).case(de.discard,(function(e,t){return ue((function(e){return function(e,t){var a=Object(y.a)(e.hand);return a.splice(t,1),Object(c.a)({},e,{hand:a})}(e,t.position)}))(e)})).case(de.draw,(function(e,t){return ue(T)(e)})).case(de.deal,(function(e,t){return ue((function(e){return G(t.deal)}))(e)})).case(de.sort,(function(e,t){return ue(A)(e)})).case(de.newGame,(function(e,t){return{game:{kind:"playing",deal:t.deal,score:0,started:t.deal.started},messages:w([],"new game started at ".concat(t.deal.started))}})).case(de.appendMessage,(function(e,t){return Object(c.a)({},e,{messages:w(e.messages,t.message)})})).case(de.scoreHu,(function(e,t){if("playing"!==e.game.kind)throw new TypeError;return Object(c.a)({},e,{game:Object(c.a)({},e.game,{score:e.game.score+Math.sqrt(t.tbd/(t.time.valueOf()-e.game.deal.started.valueOf()))})})})).case(de.scoreCuohu,(function(e,t){if("playing"!==e.game.kind)throw new TypeError;return Object(c.a)({},e,{game:Object(c.a)({},e.game,{score:e.game.score-1})})})).case(de.finish,(function(e,t){if("playing"!==e.game.kind)throw new TypeError;return console.log("finish at: ".concat(new Date)),console.log(e),console.log(t),{game:{kind:"finished",score:e.game.score},messages:w([],"finish! score: ".concat(~~(1e3*e.game.score)))}})).case(de.nullGame,(function(e,t){return Object(c.a)({},e,{game:{kind:"null"}})}));function pe(e,t,a,n,r){n(e),setTimeout((function(){n(a),r()}),t)}var me=se(de.discardAndDraw,{process:function(e,t,a){var n=e.action,r=n.payload.timeBeforeSort<=n.payload.timeBeforeDraw?[n.payload.timeBeforeSort,de.sortAndDraw({timeBetweenSortDraw:n.payload.timeBeforeDraw-n.payload.timeBeforeSort})]:[n.payload.timeBeforeDraw,de.draw({})],i=Object(b.a)(r,2),o=i[0],s=i[1];pe(de.discard({position:n.payload.position}),o,s,t,a)}}),fe=se(de.dealAndDraw,{process:function(e,t,a){var n=e.action;console.log(n);var r=n.payload.timeBeforeSort<=n.payload.timeBeforeDraw?[n.payload.timeBeforeSort,de.sortAndDraw({timeBetweenSortDraw:n.payload.timeBeforeDraw-n.payload.timeBeforeSort})]:[n.payload.timeBeforeDraw,de.draw({})],i=Object(b.a)(r,2),o=i[0],s=i[1];pe(de.deal({deal:n.payload.deal}),o,s,t,a)}}),ye=se(de.sortAndDraw,{process:function(e,t,a){var n=e.action;pe(de.sort({}),n.payload.timeBetweenSortDraw,de.draw({}),t,a)}}),ge=se(de.newGameAndDraw,{process:function(e,t,a){var n=e.action,r=n.payload.timeBeforeSort<=n.payload.timeBeforeDraw?[n.payload.timeBeforeSort,de.sortAndDraw({timeBetweenSortDraw:n.payload.timeBeforeDraw-n.payload.timeBeforeSort})]:[n.payload.timeBeforeDraw,de.draw({})],i=Object(b.a)(r,2),o=i[0],s=i[1];pe(de.newGame({deal:n.payload.deal}),o,s,t,a)}}),ve=[me,fe,se(de.resetGame,{latest:!0,warnTimeout:0,process:function(e,t,a){var n=e.action;console.log(n.payload),pe(de.newGameAndDraw({deal:n.payload.first,timeBeforeDraw:n.payload.timeBeforeDraw,timeBeforeSort:n.payload.timeBeforeSort}),n.payload.timeOfGame,de.finish({}),t,a),console.log("".concat(new Date))}}),ye,se(de.declareHu,{process:function(e,t,a){var n=e.action,r=(0,e.getState)();if("playing"!==r.game.kind)throw new TypeError;var i=n.payload.validator(function(e){var t=new Array(9).fill(0);return e.forEach((function(e){t[g(e)]+=1})),t}(r.game.deal.hand));!function(e,t,a){e.forEach((function(e){t(e)})),a()}([i?de.scoreHu({time:n.payload.next.started,tbd:n.payload.timeBeforeDraw}):de.scoreCuohu({}),de.appendMessage({message:"declared ".concat(i," hu")}),de.dealAndDraw({deal:n.payload.next,timeBeforeDraw:n.payload.timeBeforeDraw,timeBeforeSort:n.payload.timeBeforeSort})],t,a)}}),ge],we=Object(l.c)(he,Object(l.a)(Object(re.a)(ve))),be=(a(196),Object(s.b)((function(e){return e}),(function(e){return{actions:Object(l.b)(de,e)}}))(F));var Oe=function(){return r.a.createElement(s.a,{store:we},r.a.createElement(be,{initializer:v}))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(Oe,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[152,1,2]]]);
//# sourceMappingURL=main.c8e140e1.chunk.js.map